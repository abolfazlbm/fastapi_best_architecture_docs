import{_ as r,c as g,e as h,a as s,b as t,h as a,w as n,r as d,o as c}from"./app-BmTAx6X_.js";const A={},y={class:"vp-steps"},v={class:"vp-steps"};function B(o,i){const p=d("Tabs"),k=d("RouteLink");return c(),g("div",null,[i[21]||(i[21]=h('<div class="hint-container info"><p class="hint-container-title">相关信息</p><p>一个还不错的教程网站：<a href="https://yeasy.gitbook.io/docker_practice" target="_blank" rel="noopener noreferrer">Docker - 从入门到实践</a></p></div><h2 id="本地部署" tabindex="-1"><a class="header-anchor" href="#本地部署"><span>本地部署</span></a></h2><p>本地部署是为了能够快捷的提供本地 API 服务</p><h3 id="后端" tabindex="-1"><a class="header-anchor" href="#后端"><span>后端</span></a></h3>',4)),s("div",y,[s("ol",null,[i[13]||(i[13]=h('<li><p>env</p><p>在 <code>backend</code> 目录打开终端，创建环境变量文件</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">touch</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env</span></span></code></pre></div><p>将初始化环境变量配置拷贝到环境变量文件中</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">cp</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env.example</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env</span></span></code></pre></div></li><li><p>按需修改配置文件 <code>backend/core/conf.py</code> 和 <code>.env</code></p></li>',2)),s("li",null,[i[4]||(i[4]=s("p",null,"构建容器",-1)),i[5]||(i[5]=s("p",null,"在项目根目录中打开终端，执行以下命令",-1)),i[6]||(i[6]=s("div",{class:"hint-container warning"},[s("p",{class:"hint-container-title"},"注意"),s("p",null,[a("如果容器要在本地启动，需要将 "),s("code",null,".env"),a(" 中的 "),s("code",null,"127.0.0.1"),a(" 更改为 "),s("code",null,"host.docker.internal")])],-1)),t(p,{id:"46",data:[{id:"fba"},{id:"celery"}],"tab-id":"dockerfile"},{title0:n(({value:l,isActive:e})=>i[0]||(i[0]=[a("fba")])),title1:n(({value:l,isActive:e})=>i[1]||(i[1]=[a("celery")])),tab0:n(({value:l,isActive:e})=>i[2]||(i[2]=[s("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[s("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," build"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -f"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," Dockerfile"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -t"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_backend_independent"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," .")])])])],-1)])),tab1:n(({value:l,isActive:e})=>i[3]||(i[3]=[s("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[s("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," build"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --build-arg"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," SERVER_TYPE=celery"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -t"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_celery_independent"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," .")])])])],-1)])),_:1})]),s("li",null,[i[11]||(i[11]=s("p",null,"启动容器",-1)),i[12]||(i[12]=s("p",null,"由于构建不包含数据库，请确保本地已安装并启动相关数据库（mysql / postgresql、redis）",-1)),t(p,{id:"62",data:[{id:"fba"},{id:"celery"}],"tab-id":"dockerfile"},{title0:n(({value:l,isActive:e})=>i[7]||(i[7]=[a("fba")])),title1:n(({value:l,isActive:e})=>i[8]||(i[8]=[a("celery")])),tab0:n(({value:l,isActive:e})=>i[9]||(i[9]=[s("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[s("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," run"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -d"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -p"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," 8000:8000"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --name"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_server"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_backend_independent")])])])],-1)])),tab1:n(({value:l,isActive:e})=>i[10]||(i[10]=[s("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[s("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[s("code",{class:"language-shell"},[s("span",{class:"line"},[s("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," run"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -d"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -p"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," 8555:8555"),s("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --name"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_celery"),s("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_celery_independent")])])])],-1)])),_:1})])])]),i[22]||(i[22]=s("h3",{id:"前端",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#前端"},[s("span",null,"前端")])],-1)),s("p",null,[t(k,{to:"/frontend/quick-start.html"},{default:n(()=>i[14]||(i[14]=[a("点击跳转")])),_:1,__:[14]})]),i[23]||(i[23]=h('<h2 id="服务器部署" tabindex="-1"><a class="header-anchor" href="#服务器部署"><span>服务器部署</span></a></h2><div class="hint-container tip"><p class="hint-container-title">提示</p><p>此教程以 https 为例，如果你没有相关经验，请自行 Google 进行了解</p></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>免费 SSL 证书推荐使用 <a href="https://httpsok.com/p/4Qjd" target="_blank" rel="noopener noreferrer">httpsok-SSL 证书自动续期</a>，一行命令，轻松搞定 SSL 证书自动续签，支持：nginx、通配符证书、七牛云、腾讯云、阿里云、CDN、OSS、LB（负载均衡）</p></div><h3 id="后端-1" tabindex="-1"><a class="header-anchor" href="#后端-1"><span>后端</span></a></h3>',4)),s("div",v,[s("ol",null,[s("li",null,[i[17]||(i[17]=s("p",null,"拉取代码到服务器",-1)),i[18]||(i[18]=s("p",null,"将代码拉取到服务器通常采用 ssh 方式（更安全），但是你也可以选择使用 https 方式，具体方式请根据个人自行决定，如果使用 ssh 方式拉取代码，请自行 Google 拉取教程",-1)),s("p",null,[i[16]||(i[16]=a("如果使用 https 方式，你可以查看 ")),t(k,{to:"/backend/summary/quick-start.html#%E5%90%8E%E7%AB%AF"},{default:n(()=>i[15]||(i[15]=[a("后端步骤 2")])),_:1,__:[15]})])]),i[19]||(i[19]=h(`<li><p>env</p><p>在 <code>backend</code> 目录打开终端，创建环境变量文件</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">touch</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env</span></span></code></pre></div><p>进入 <code>deploy/backend/docker-compose</code> 目录，按需修改 <code>.env.server</code> 文件</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>我们在 docker-compose 脚本内通过挂载的方式使用 <code>.env.server</code> 文件作为 fba 环境变量文件，因此，本地修改此文件，将同步更新至 docker 容器，这意味着，修改环境变量将无需重新 build</p></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果您正在使用 PostgreSQL 数据库，需修改 <code>.env.server</code> 部分配置如下：</p><div class="language-dotenv" data-highlighter="shiki" data-ext="dotenv" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-dotenv"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;"># Database</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_TYPE</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;postgresql&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_HOST</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;fba_postgres&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_PORT</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">5432</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_USER</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;postgres&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_PASSWORD</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;123456&#39;</span></span></code></pre></div></div></li><li><p>按需修改配置文件 <code>backend/core/conf.py</code></p></li><li><p>更新脚本文件</p><div class="language-yml line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="yml" style="--vp-collapsed-lines:6;--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light has-highlighted vp-code"><code class="language-yml"><span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">services</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_server</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    build</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      context</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">.</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      dockerfile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">Dockerfile</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_server:latest</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_server</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">    # 如果你是 postgres 用户，应将 fba_mysql 修改为 fba_postgres</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    depends_on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_mysql</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_redis</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_celery</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">./deploy/backend/docker-compose/.env.server:/fba/backend/.env</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static:/fba/backend/app/static</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static_upload:/fba/backend/static/upload</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">    # 如果你是 postgres 用户，应将 fba_mysql:3306 修改为 fba_postgres:5432</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    command</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">bash</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">-c</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#C678DD;--shiki-light:#A626A4;">|</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">        wait-for-it -s fba_mysql:3306 -s fba_redis:6379 -t 300</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">        supervisord -c /etc/supervisor/supervisord.conf</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">        supervisorctl restart</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_mysql</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">mysql:8.0.41</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;\${DOCKER_MYSQL_MAP_PORT:-3306}:3306&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_mysql</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    environment</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      MYSQL_DATABASE</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      MYSQL_ROOT_PASSWORD</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">123456</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      TZ</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_mysql:/var/lib/mysql</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    command</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">      --default-authentication-plugin=mysql_native_password</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">      --character-set-server=utf8mb4</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">      --collation-server=utf8mb4_general_ci</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">      --lower_case_table_names=1</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">  </span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 如果你是 postgres 用户，应保留 fba_postgres 容器脚本并删除 fba_mysql 容器脚本</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 否则，删除 fba_postgres 容器脚本</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_postgres</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">postgres:16</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;\${DOCKER_POSTGRES_MAP_PORT:-5432}:5432&quot;</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_postgres</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    environment</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      POSTGRES_DB</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      POSTGRES_PASSWORD</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">123456</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      TZ</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">Asia/Shanghai</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_postgres:/var/lib/postgresql/data</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_redis</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">redis</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;\${DOCKER_REDIS_MAP_PORT:-6379}:6379&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_redis</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    environment</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">TZ=Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_redis:/data</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 后端专用，如果使用此容器，意味着你只需部署后端 API 服务，不需要前端；</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 这与下面的 fba_ui 容器冲突，如果你选择使用 fba_ui 容器</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 你应该注释或删除 fba_nginx 容器脚本，并使用 fba_ui 容器</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_nginx</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">nginx</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;8000:80&quot;</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_nginx</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    depends_on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_server</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">./deploy/backend/nginx.conf:/etc/nginx/conf.d/default.conf:ro</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static:/www/fba_server/backend/static</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static_upload:/www/fba_server/backend/static/upload</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 如果服务器内存小于 4GB，CPU 小于四个内核</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 建议进入 fba_ui 项目单独构建这个容器（参考下方前端部署教程）</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 如果你不选择单独构建，务必在执行下面步骤前根据前端部署教程更新前端配置文件</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 如果你选择单独构建，务必注释或删除此容器脚本</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_ui</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    build</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      context</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">/root/fastapi_best_architecture_ui</span><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 根据 Vben Admin Antd 项目存放目录修改此路径</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      dockerfile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">Dockerfile</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_ui:latest</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;80:80&quot;</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;443:443&quot;</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_ui</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    depends_on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_server</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    command</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">nginx</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">-g</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">daemon off;</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # nginx https conf</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # 通过 docker 进行部署时，需要打开此配置项并确保&lt;挂载到容器内的证书文件路径&gt;配置</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # 与 nginx conf 中的 ssl 证书文件路径配置一致，如果你直接将 ssl 证书文件 cp</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # 到了 docker 容器内，则无需挂载证书文件，直接将它们注释或删除即可</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # local_ssl_pem_path：你在服务器存放 ssl pem 证书文件的路径，自行修改</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # local_ssl_key_path: 你在服务器存放 ssl key 证书文件的路径，自行修改</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # /etc/ssl/xxx.pem：挂载到容器内 ssl pem 证书文件的路径，自行修改</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">      # /etc/ssl/xxx.key：挂载到容器内 ssl key 证书文件的路径，自行修改</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">local_ssl_pem_path:/etc/ssl/xxx.pem</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">local_ssl_key_path:/etc/ssl/xxx.key</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static:/www/fba_server/backend/static</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static_upload:/www/fba_server/backend/static/upload</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_rabbitmq</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    hostname</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_rabbitmq</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">rabbitmq:3.13.7</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;15672:15672&quot;</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;5672:5672&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_rabbitmq</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    environment</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">RABBITMQ_DEFAULT_USER=guest</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">RABBITMQ_DEFAULT_PASS=guest</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_rabbitmq:/var/lib/rabbitmq</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_celery</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    build</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      context</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">.</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      dockerfile</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">Dockerfile</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      args</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">        - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">SERVER_TYPE=celery</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_celery:latest</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&quot;8555:8555&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_celery</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">always</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    depends_on</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_rabbitmq</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">./deploy/backend/docker-compose/.env.server:/fba/backend/.env</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    command</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">bash</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">-c</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#C678DD;--shiki-light:#A626A4;">|</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">        wait-for-it -s fba_rabbitmq:5672 -t 300</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">        supervisord -c /etc/supervisor/supervisord.conf</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">        supervisorctl restart</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">networks</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_network</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_network</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    driver</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">bridge</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    ipam</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      driver</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">default</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">      config</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">        - </span><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">subnet</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">172.10.10.0/24</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">volumes</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;">  # 如果你是 postgres 用户，应将 fba_mysql 修改为 fba_postgres</span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_mysql</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span></span>
<span class="line highlighted warning"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_mysql</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_redis</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_redis</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_static</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_static_upload</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_static_upload</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">  fba_rabbitmq</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">    name</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">fba_rabbitmq</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div></li><li><p>执行一键启动命令</p><p>在项目根目录中打开终端，执行以下命令</p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>命令执行期间遇到镜像拉取问题请自行 Google</p></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">docker-compose</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> up</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;"> -d</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;"> --build</span></span></code></pre></div></li><li><p>等待命令执行完成</p></li>`,5))])]),i[24]||(i[24]=s("h3",{id:"前端-1",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#前端-1"},[s("span",null,"前端")])],-1)),s("p",null,[t(k,{to:"/frontend/docker.html"},{default:n(()=>i[20]||(i[20]=[a("点击跳转")])),_:1,__:[20]})]),i[25]||(i[25]=h('<h2 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h2><div class="hint-container warning"><p class="hint-container-title">注意</p><p>不建议频繁使用 <code>docker-compose up -d --build</code> 命令，此命令每次执行都会重新构建容器，并将原容器自动本地备份保留，这会导致硬盘空间迅速锐减</p></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><p><a href="https://www.yuque.com/fcant/devops/itkfyytisf9z84y6" target="_blank" rel="noopener noreferrer">15 个 Docker 容器自动化管理的脚本</a></p></div><p>清理未使用的镜像</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> image</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> prune</span></span></code></pre></div><p>清理未使用的容器</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> container</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> prune</span></span></code></pre></div><p>清理所有未使用的镜像、容器、网络和构建缓存</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> system</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> prune</span></span></code></pre></div>',9))])}const F=r(A,[["render",B]]),u=JSON.parse('{"path":"/backend/deploy/Docker.html","title":"Docker 部署","lang":"zh-CN","frontmatter":{"title":"Docker 部署","description":"相关信息 一个还不错的教程网站：Docker - 从入门到实践 本地部署 本地部署是为了能够快捷的提供本地 API 服务 后端 env 在 backend 目录打开终端，创建环境变量文件 将初始化环境变量配置拷贝到环境变量文件中 按需修改配置文件 backend/core/conf.py 和 .env 构建容器 在项目根目录中打开终端，执行以下命令 注...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker 部署\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://fastapi-practices.github.io/fastapi_best_architecture_docs/fastapi_best_architecture_docs/backend/deploy/Docker.html"}],["meta",{"property":"og:site_name","content":"FastAPI Best Architecture"}],["meta",{"property":"og:title","content":"Docker 部署"}],["meta",{"property":"og:description","content":"相关信息 一个还不错的教程网站：Docker - 从入门到实践 本地部署 本地部署是为了能够快捷的提供本地 API 服务 后端 env 在 backend 目录打开终端，创建环境变量文件 将初始化环境变量配置拷贝到环境变量文件中 按需修改配置文件 backend/core/conf.py 和 .env 构建容器 在项目根目录中打开终端，执行以下命令 注..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}]]},"readingTime":{"minutes":2.71,"words":812},"git":{"createdTime":1726501588000},"autoDesc":true,"filePathRelative":"backend/deploy/Docker.md","headers":[],"categoryList":[{"id":"b43fdd","sort":10000,"name":"backend"},{"id":"167cf3","sort":10004,"name":"deploy"}],"bulletin":true}');export{F as comp,u as data};
